<script aria-label="component-maker-js.html">

    let version = "1.0.202306181515"

    class CConfig {
        /** @type{} */
        #propMap = new Map()
    }
    class CData {
        data = {}
        /** @type {Map<string, PropertyDescriptor | undefined} */
        props = new Map()
        /** @type {Map<string, [string]>} */
        dependentPropList = new Map()
        /** @type {Map<string, string>} */
        bindings = new Map()

        /** @type {HTMLElement} */
        myElement = null
        /** @type {ShadowRoot} */
        myShadowRoot

        /** 
         * @param {{ele: HTMLElement, root: ShadowRoot}} c
        */
        constructor(c) {
            let { ele, root } = c
            this.myElement = ele
            this.myShadowRoot = root

            initiateMyElement()
        }

        initiateMyElement() {
            /** @type {CData} */
            let me = this

            Object.defineProperty(this.myElement, "data", {
                configurable: true, enumerable: true,
                get() { return me.data },
                set(v) { me.data = v }
            })


        }

        addProps() { }



    }
    class CUI {
        #shadowRoot
        #me


    }
    class CMaker {
        static get version() { return version }
        static async make(uiPth) {

            console.log(uiPth)
            try {
                let uiHtml, uiScript, uiData, uiAttrs, uiEvts;


                let lcc = class extends HTMLElement {
                    #cdata


                    constructor() {
                        super()
                        this.attachShadow({ mode: "open" })
                        this.#cdata = new CData({ me: this, root: this.shadowRoot })
                    }

                    set data(v) {
                        this.#cdata.data = v
                    }
                    //get props() { return this.#props }


                    /** @param {{derived:boolean}} options */
                    listProps(options) {
                        let { derived } = options
                        if (derived) return [...new Set([...this.#cdata.derivedProps.values()].flatMap(f => f))]
                        return [...this.#cdata.props.keys()]
                    }
                    /** 
                     * @desc {$prop1 : "data1.data2.leaf1", $prop2 : "data1.data2.leaf2"}
                     * @param {any} bindings - 
                    */
                    updateBindings(bindings) {

                    }

                }

                return lcc
            }
            catch (err) {
                console.log(err)
            }

        }
    }

</script>